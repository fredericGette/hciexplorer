<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        .blocs {
            display: flex;
            flex-direction: column;
        }

        .bloc {
            border: 1px solid;
            border-radius: 0.25rlh;
            font: 0.8rem "Fira Sans", sans-serif;
        }

        .command {
            background-color: #FFC0C0;
        }

        .event {
            background-color: #C0C0FF;
        }

        .data {
            background-color: #C0FFC0;
        }
    </style>
</head>
<body>
<div>
    <form method="POST" enctype="multipart/form-data" action="http://localhost:8080/upload">
        <table>
            <tr><td>File to upload:</td><td><input type="file" name="file" /></td></tr>
            <tr><td></td><td><input type="submit" value="Upload" /></td></tr>
        </table>
    </form>
</div>
<div>
    <button onclick="downloadBlocs()">Blocs</button>
</div>
<div id="blocs">
</div>
<script type="text/javascript">
    async function downloadBlocs() {
        debugger;
        const response = await fetch('http://localhost:8080/blocs');
        const blocs = await response.json();
        console.log(blocs);

        const divBlocs = document.getElementById("blocs");

        blocs.forEach(bloc => {
            const divBloc = document.createElement("div");
            divBloc.classList.add('bloc');
            if (bloc.command != undefined)
            {
                divBloc.classList.add('command');
                divBloc.innerHTML += ""+bloc.command.id+" "+bloc.command.opCode;

                divBloc.innerHTML += "<br/>"
                if (bloc.status != undefined)
                {
                    divBloc.innerHTML += "Status:"+bloc.status.status;
                }

                divBloc.innerHTML += "<br/>"
                if (bloc.result != undefined)
                {
                    divBloc.innerHTML += "Result:"+bloc.result.status;
                }
            }
            else if (bloc.event != undefined)
            {
                divBloc.classList.add('event');
                divBloc.innerHTML += ""+bloc.event.id+" "+bloc.event.code;
            }
            else if (bloc.data != undefined)
            {
                divBloc.classList.add('data');
                divBloc.innerHTML += ""+bloc.data.id+" "+bloc.data.direction;
            }

            divBlocs.appendChild(divBloc);
        });
    }
</script>
</body>
</html>
