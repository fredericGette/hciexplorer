<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        #events {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            grid-template-rows: repeat(26, 1rlh);
        }

        .event {
            border: 1px solid;
            border-radius: 0.25rlh;
        }
    </style>
</head>
<body>
<div>
    <form method="POST" enctype="multipart/form-data" action="http://localhost:8080/upload">
        <table>
            <tr><td>File to upload:</td><td><input type="file" name="file" /></td></tr>
            <tr><td></td><td><input type="submit" value="Upload" /></td></tr>
        </table>
    </form>
</div>
<div>
    <button onclick="downloadEvents()">Events</button>
</div>
<div id="events">
</div>
<script type="text/javascript">
    async function downloadEvents() {
        debugger;
        const response = await fetch('http://localhost:8080/eventMessages');
        const events = await response.json();
        console.log(events);

        let last0 = new Date('01 Jan 1970 00:00:00 GMT');
        let last1 = new Date('01 Jan 1970 00:00:00 GMT');
        let row0 = -1;
        let row1 = -1;
        let previousColumn = 0;
        let eventNumber = 1;
        let lastDivEvent0;
        events.forEach(event => {
            event.beginTimestamp = new Date(event.beginTimestamp);
            event.endTimestamp = new Date(event.endTimestamp);

            const divEvent = document.createElement("div");
            divEvent.classList.add('event');
            divEvent.innerHTML += ''+eventNumber+' '+event.beginTimestamp.getTime()+'<br/>'+event.endTimestamp.getTime()+'';

            if (last0.getTime()<=event.beginTimestamp.getTime())
            {
                last0 = event.endTimestamp
                if (previousColumn==1)
                {
                    row0 = row1+2;
                }
                else
                {
                    row0+=2;
                }
                divEvent.setAttribute("style","grid-column-start: 1; grid-row-start: "+row0+"; grid-row-end: "+(row0+2));
                lastDivEvent0=divEvent;
                previousColumn = 0;
            }
            else
            {
                last1 = event.endTimestamp
                if (previousColumn==0)
                {
                    row1 = row0+1;
                }
                else
                {
                    row1+=2;
                }
                divEvent.setAttribute("style","grid-column-start: 2; grid-row-start: "+row1+"; grid-row-end: "+(row1+2));
                lastDivEvent0.setAttribute("style","grid-column-start: 1; grid-row-start: "+row0+"; grid-row-end: "+(row1+2));
                previousColumn = 1;
            }

            document.getElementById("events").appendChild(divEvent);
            eventNumber++;
        });
    }
</script>
</body>
</html>